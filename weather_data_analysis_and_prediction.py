# -*- coding: utf-8 -*-
"""Weather Data Analysis and Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1oGVfpX6vG31o8u23asJG1_JvvR2E4PD2
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error,r2_score

df=pd.read_csv("Weather_Dataset.csv")

print("Rows")
print(df.head())

print("\nInfo:")
print(df.info())

print("\nColumn")
print(list(df.columns))

print("\nShape")
print(df.shape)

print("\nStatistics:")
print(df.describe())

print("\nMissing Values:")
print(df.isnull().sum())

df['Date/Time'] = pd.to_datetime(df['Date/Time'], errors='coerce')

df=df.dropna(subset=['Date/Time','Temp_C'])

df=df.sort_values('Date/Time')

df['Year']=df['Date/Time'].dt.year
df['Month']=df['Date/Time'].dt.month
df['Day']=df['Date/Time'].dt.day
df['Hour']=df['Date/Time'].dt.hour

plt.figure(figsize=(12,6))
sns.lineplot(x='Date/Time',y='Temp_C',data=df)
plt.title("Temperature Trends Over Time")
plt.xlabel("Date/Time")
plt.ylabel("Temperature (°C)")
plt.show()

plt.figure(figsize=(10,5))
sns.countplot(y='Weather',data=df,order=df['Weather'].value_counts().index)
plt.title("Distribution of Weather Conditions")
plt.show()

X=df[['Year','Month','Day','Hour','Rel Hum_%','Wind Speed_km/h','Visibility_km','Press_kPa']]
y=df['Temp_C']
lin_reg=LinearRegression()
lin_reg.fit(X,y)
y_pred=lin_reg.predict(X)
print("Regression R²:",r2_score(y,y_pred))
print("MSE:",mean_squared_error(y,y_pred))

plt.figure(figsize=(12,6))
plt.scatter(df['Date/Time'],y,label="Actual",alpha=0.6)
plt.plot(df['Date/Time'],y_pred,color='red',label="Regression Fit")
plt.title("Temperature Trend")
plt.xlabel("Date/Time")
plt.ylabel("Temperature (degree C)")
plt.legend()
plt.show()

last_date=df['Date/Time'].max()
future_dates=pd.date_range(last_date,periods=25,freq='H')[1:]
last_row=df.iloc[-1]
future_df=pd.DataFrame({'Year':future_dates.year,'Month':future_dates.month,'Day':future_dates.day,'Hour':future_dates.hour,'Rel Hum_%':last_row['Rel Hum_%'],'Wind Speed_km/h':last_row['Wind Speed_km/h'],'Visibility_km':last_row['Visibility_km'],'Press_kPa':last_row['Press_kPa']
})
future_preds=lin_reg.predict(future_df)

plt.figure(figsize=(12,6))
plt.plot(df['Date/Time'],y,label="Historical")
plt.plot(future_dates, future_preds, color='green',label="Future Prediction")
plt.title("Future Temperature Prediction")
plt.xlabel("Date/Time")
plt.ylabel("Temperature(degree C)")
plt.legend()
plt.show()

print("\nFuture Temperature Predictions:")
for date,temp in zip(future_dates, future_preds):
    print(f"{date.strftime('%Y-%m-%d %H:%M')}->{temp:.2f} °C")